(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{658:function(e,t,r){"use strict";r.r(t);var o=r(1),a=Object(o.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"go-style-guide"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#go-style-guide"}},[e._v("#")]),e._v(" Go style guide")]),e._v(" "),r("p",[e._v('In order to keep our code looking good with lots of programmers working on it, it helps to have a "style guide", so all the code generally looks quite similar. This doesn\'t mean there is only one "right way" to write code, or even that this standard is better than your style.  But if we agree to a number of stylistic practices, it makes it much easier to read and modify new code. Please feel free to make suggestions if there\'s something you would like to add or modify.')]),e._v(" "),r("p",[e._v("We expect all contributors to be familiar with "),r("a",{attrs:{href:"https://golang.org/doc/effective_go.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Effective Go"),r("OutboundLink")],1),e._v(" (and it's recommended reading for all Go programmers anyways). Additionally, we generally agree with the suggestions in "),r("a",{attrs:{href:"https://github.com/uber-go/guide/blob/master/style.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("Uber's style guide"),r("OutboundLink")],1),e._v(" and use that as a starting point.")]),e._v(" "),r("h2",{attrs:{id:"code-structure"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#code-structure"}},[e._v("#")]),e._v(" Code Structure")]),e._v(" "),r("p",[e._v("Perhaps more key for code readability than good commenting is having the right structure. As a rule of thumb, try to write in a logical order of importance, taking a little time to think how to order and divide the code such that someone could scroll down and understand the functionality of it just as well as you do. A loose example of such order would be:")]),e._v(" "),r("ul",[r("li",[e._v("Constants, global and package-level variables.")]),e._v(" "),r("li",[e._v("Main struct definition.")]),e._v(" "),r("li",[e._v("Options (only if they are seen as critical to the struct else they should be placed in another file).")]),e._v(" "),r("li",[e._v("Initialization/start and stop of the service functions.")]),e._v(" "),r("li",[e._v("Public functions (in order of most important).")]),e._v(" "),r("li",[e._v("Private/helper functions.")]),e._v(" "),r("li",[e._v("Auxiliary structs and function (can also be above private functions or in a separate file).")])]),e._v(" "),r("h2",{attrs:{id:"general"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#general"}},[e._v("#")]),e._v(" General")]),e._v(" "),r("ul",[r("li",[e._v("Use "),r("code",[e._v("gofumpt")]),e._v(" to format all code upon saving it (or run "),r("code",[e._v("make format")]),e._v(").")]),e._v(" "),r("li",[e._v("Think about documentation, and try to leave godoc comments, when it will help new developers.")]),e._v(" "),r("li",[e._v("Every package should have a high level doc.go file to describe the purpose of that package, its main functions, and any other relevant information.")]),e._v(" "),r("li",[e._v("Applications (e.g. clis/servers) should panic on unexpected unrecoverable errors and print a stack trace.")])]),e._v(" "),r("h2",{attrs:{id:"comments"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#comments"}},[e._v("#")]),e._v(" Comments")]),e._v(" "),r("ul",[r("li",[r("p",[e._v("Use a space after the comment deliminter (ex. "),r("code",[e._v("// your comment")]),e._v(").")])]),e._v(" "),r("li",[r("p",[e._v("Many comments are not sentences. These should begin with a lower case letter and end without a period.")])]),e._v(" "),r("li",[r("p",[e._v("Conversely, sentences in comments should be sentenced-cased and end with a period.")])]),e._v(" "),r("li",[r("p",[e._v("Comments should explain "),r("em",[e._v("why")]),e._v(" something is being done rather than "),r("em",[e._v("what")]),e._v(" the code is doing. For example:")]),e._v(" "),r("p",[e._v("The comments in")]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"Ly8gYXNzaWduIGEgdmFyaWFibGUgZm9vCmYgOj0gZm9vCi8vIGFzc2lnbiBmIHRvIGIKYiA6PSBmCg=="}}),e._v(" "),r("p",[e._v("have little value,\tbut the following is more useful:")]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"ZiA6PSBmb28KLy8gd2UgY29weSB0aGUgdmFyaWFibGUgZiBiZWNhdXNlIHdlIHdhbnQgdG8gcHJlc2VydmUgdGhlIHN0YXRlIGF0IHRpbWUgb2YgaW5pdGlhbGl6YXRpb24KYiA6PSBmCg=="}})],1)]),e._v(" "),r("h2",{attrs:{id:"linting"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#linting"}},[e._v("#")]),e._v(" Linting")]),e._v(" "),r("ul",[r("li",[e._v("Run "),r("code",[e._v("make lint-fix")]),e._v(" to fix any linting errors.")])]),e._v(" "),r("h2",{attrs:{id:"various"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#various"}},[e._v("#")]),e._v(" Various")]),e._v(" "),r("ul",[r("li",[r("p",[e._v("Functions that return functions should have the suffix "),r("code",[e._v("Fn")]),e._v(".")])]),e._v(" "),r("li",[r("p",[e._v("Names should not "),r("a",{attrs:{href:"https://blog.golang.org/package-names",target:"_blank",rel:"noopener noreferrer"}},[e._v("stutter"),r("OutboundLink")],1),e._v(". For example, a struct generally shouldnâ€™t have a field named after itself; e.g., this shouldn't occur:")]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:" golang",base64:"dHlwZSBtaWRkbGV3YXJlIHN0cnVjdCB7CgltaWRkbGV3YXJlIE1pZGRsZXdhcmUKfQo="}})],1),e._v(" "),r("li",[r("p",[e._v('Acronyms are all capitalized, like "RPC", "gRPC", "API". "MyID", rather than "MyId".')])]),e._v(" "),r("li",[r("p",[e._v("Whenever it is safe to use Go's built-in "),r("code",[e._v("error")]),e._v(" instantiation functions (as opposed to Cosmos SDK's error instantiation functions), prefer "),r("code",[e._v("errors.New()")]),e._v(" instead of "),r("code",[e._v("fmt.Errorf()")]),e._v(" unless you're actually using the format feature with arguments.")])])]),e._v(" "),r("h2",{attrs:{id:"importing-libraries"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#importing-libraries"}},[e._v("#")]),e._v(" Importing libraries")]),e._v(" "),r("ul",[r("li",[e._v("Use "),r("a",{attrs:{href:"https://godoc.org/golang.org/x/tools/cmd/goimports",target:"_blank",rel:"noopener noreferrer"}},[e._v("goimports"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("li",[e._v("Separate imports into blocks: one for the standard lib, one for external libs and one for application libs. For example:")])]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKICAvLyBzdGFuZGFyZCBsaWJyYXJ5IGltcG9ydHMKICAmcXVvdDtmbXQmcXVvdDsKICAmcXVvdDt0ZXN0aW5nJnF1b3Q7CiAgICAgIAogIC8vIGV4dGVybmFsIGxpYnJhcnkgaW1wb3J0cwogICZxdW90O2dpdGh1Yi5jb20vc3RyZXRjaHIvdGVzdGlmeS9yZXF1aXJlJnF1b3Q7CiAgYWJjaSAmcXVvdDtnaXRodWIuY29tL2NvbWV0YmZ0L2NvbWV0YmZ0L2FiY2kvdHlwZXMmcXVvdDsKICAgICAgCiAgLy8gaWJjLWdvIGxpYnJhcnkgaW1wb3J0cwogICZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2liYy1nby9tb2R1bGVzL2NvcmUvMjMtY29tbWl0bWVudC90eXBlcyZxdW90OwopCg=="}}),e._v(" "),r("h2",{attrs:{id:"dependencies"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dependencies"}},[e._v("#")]),e._v(" Dependencies")]),e._v(" "),r("ul",[r("li",[e._v("Dependencies should be pinned by a release tag, or specific commit, to avoid breaking "),r("code",[e._v("go get")]),e._v(" when external dependencies are updated.")]),e._v(" "),r("li",[e._v("Refer to the "),r("RouterLink",{attrs:{to:"/dev/development-setup.html#dependencies"}},[e._v("contributing")]),e._v(" document for more details.")],1)]),e._v(" "),r("h2",{attrs:{id:"testing"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#testing"}},[e._v("#")]),e._v(" Testing")]),e._v(" "),r("ul",[r("li",[e._v("Make use of table driven testing where possible and not-cumbersome. Read "),r("a",{attrs:{href:"https://dave.cheney.net/2013/06/09/writing-table-driven-tests-in-go",target:"_blank",rel:"noopener noreferrer"}},[e._v("this blog post"),r("OutboundLink")],1),e._v(" for more information. See the "),r("a",{attrs:{href:"https://github.com/cosmos/ibc-go/blob/f24f41ea8a61fe87f6becab94e84de08c8aa9381/modules/apps/transfer/keeper/msg_server_test.go#L11",target:"_blank",rel:"noopener noreferrer"}},[e._v("tests"),r("OutboundLink")],1),e._v(" for "),r("a",{attrs:{href:"https://github.com/cosmos/ibc-go/blob/f24f41ea8a61fe87f6becab94e84de08c8aa9381/modules/apps/transfer/keeper/msg_server.go#L15",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Transfer")]),r("OutboundLink")],1),e._v(" for an example.")]),e._v(" "),r("li",[e._v("Make use of Testify "),r("a",{attrs:{href:"https://godoc.org/github.com/stretchr/testify/assert",target:"_blank",rel:"noopener noreferrer"}},[e._v("assert"),r("OutboundLink")],1),e._v(" and "),r("a",{attrs:{href:"https://godoc.org/github.com/stretchr/testify/require",target:"_blank",rel:"noopener noreferrer"}},[e._v("require"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("li",[e._v("When using mocks, it is recommended to use Testify "),r("a",{attrs:{href:"https://pkg.go.dev/github.com/stretchr/testify/mock",target:"_blank",rel:"noopener noreferrer"}},[e._v("mock"),r("OutboundLink")],1),e._v(" along with "),r("a",{attrs:{href:"https://github.com/vektra/mockery",target:"_blank",rel:"noopener noreferrer"}},[e._v("Mockery"),r("OutboundLink")],1),e._v(" for autogeneration.")])]),e._v(" "),r("h2",{attrs:{id:"errors"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#errors"}},[e._v("#")]),e._v(" Errors")]),e._v(" "),r("ul",[r("li",[r("p",[e._v("Ensure that errors are concise, clear and traceable.")])]),e._v(" "),r("li",[r("p",[e._v("Depending on the context, use either "),r("code",[e._v("cosmossdk.io/errors")]),e._v(" or "),r("code",[e._v("stdlib")]),e._v(" error packages.")])]),e._v(" "),r("li",[r("p",[e._v("For wrapping errors, use "),r("code",[e._v("fmt.Errorf()")]),e._v(" with "),r("code",[e._v("%w")]),e._v(".")])]),e._v(" "),r("li",[r("p",[e._v("Panic is appropriate when an internal invariant of a system is broken, while all other cases (in particular, incorrect or invalid usage) should return errors.")])]),e._v(" "),r("li",[r("p",[e._v("Error messages should be formatted as following:")]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"c2RrZXJyb3JzLldyYXBmKAoJJmx0O21vc3Qgc3BlY2lmaWMgZXJyb3IgdHlwZSBwb3NzaWJsZSZndDssCgkmcXVvdDsmbHQ7b3B0aW9uYWwgdGV4dCBkZXNjcmlwdGlvbiBlbmRlZCBieSBjb2xvbiBhbmQgc3BhY2UmZ3Q7ZXhwZWN0ZWQgJXMsIGdvdCAlcyZxdW90OywKCSZsdDt2YWx1ZSAxJmd0OywKCSZsdDt2YWx1ZSAyJmd0OwopCg=="}})],1)])],1)}),[],!1,null,null,null);t.default=a.exports}}]);